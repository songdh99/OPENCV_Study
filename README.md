# Opencv presentation

## 3.1

### Point_ 클래스

- 2차원 평면 위에 있는 점의 좌표를 표현하는 템플릿 클래스
- Point_ 클래스는 2차원 좌표를 나타내는 x와 y라는 이름의 멤버변수가 존재
- 어떤 자료를 표현 할 것인지 자료형을 명시
  - 정수 좌표 Point2i
  - 실수 좌표 Point2f
  - 소숫점 좌표 Point2d

### Size_ 클래스

- 영상 또는 사각형 영역의 크기를 표현
- 사각형의 가로(width), 세로 (height)의 멤버변수 존재

### Rect_ 클래스

- 사각형의 위치와 크기정보를 표현
- 사각형의 좌측 상단 점의 좌표를 나타내는  x, y의 멤버변수와 사각형의 가로, 세로 크기를 나타내는 멤버변수 존재

### RotatedRect 클래스

- 회전된 사각형 표현
- 회전된 사각형의 중심좌표 center, 사각형의 가로, 세로 크기를 나타내는 size, 회전 각도인 angle을 멤버 변수로 가짐.

### Range 클래스

- 범위 또는 구간을 표현하는 클래스.
- 범위의 시작과 끝을 나타내는 start와 end 의 멤버 변수 존재

### String 클래스

- c++라이브러리에서 std::string 클래스를 이용하여 문자열을 저장하고 처리하듯 cv::string을 통해 문자열을 저장하고 처리함.



## 3.2

### Mat 클래스

- Mat::Mat(int rows, int cols, int type); <img 1, 2>

  - rows : 새로만들 행렬의 행 개수(영상의 세로크기)
  - cols : 새로만들 행렬의 열 개수(영상의 가로크기)
  - type : 새로 만들 행렬의 타입(메크로 상수 전달)

- Mat::Mat(Size size, int type); <img 3, 4>

  - size : 새로만들 행렬의 크기.
  - type : 새로만들 행렬의 타입(메크로 상수 전달)

- Mat::Mat(int rows, int cols, int type, const Scalar& s)

  Mat::Mat(Size size, int type, const Scalar& s)  <img 5,6>

  - rows : 새로만들 행렬의 행 개수(영상의 세로크기)
  - cols : 새로만들 행렬의 열 개수(영상의 가로크기)
  - size : 새로만들 행렬의 크기.
  - type : 새로만들 행렬의 타입(메크로 상수 전달)
  - s : 행렬 원소 초깃값
    - Scalar 클래스는 네개의 실수 값을 저장할 수 있는 OpenCV 클래스이며, 영상의 픽셀 값을 표현하는 용도로 사용.
    - Scalar 클래스가 그 레이스케일(백색과 흑색 사이의 회색영역을 표시하기 위하여, 백색과 흑색의 비율을 변화시킨 일련의 색조)영상의 픽셀 값을 표현할 때에는 하나의 멤버 변수만 사용하고, 3채널 영상의 픽셀 값을 표현 할때는 세 개의 멤버 변수를 사용합니다.

- Mat1::zeros(int row, int cols, int type)

  - 행렬의 모든 원소가 0.

- Mat::ones(int row, int cols, int type)

  - 행렬의 모든 원소가 1.

- Mat::ones(int row, int cols, int type)

  - 단위 행렬도 초기화.

### 행렬의 복사

- Mat img1 = imread("dog.bmp");

  - 파일 불러와서 Mat타입의 변수 img1에 저장.

- Mat img2 = img1;

  - 복사 생성자(얕은 복사)

  - 얕은 복사란?

    1. 객체를 복사할 때, 해당 객체만 복사하여 새 객체를 생성한다. 

    2. 복사된 객체의 인스턴스 변수는 원본 객체의 인스턴스 변수와 같은 메모리 주소를 참조한다.

    3. 따라서, 해당 메모리 주소의 값이 변경되면 원본 객체 및 복사 객체의 인스턴스 변수 값은 같이 변경된다.

- img3 = img1;

  - 대입 연산자(얕은복사)

- Mat img4 = img1.clone();

  - 깊은 복사

    1. 객체를 복사 할 때, 해당 객체와 인스턴스 변수까지 복사하는 방식.

    2. 전부를 복사하여 새 주소에 담기 때문에 참조를 공유하지 않는다.

  - Mat::clone() 함수는 자기 자신과 동일한 Mat 객체를 완전히 새로 만들어서 반환.

- img1.copyTo(img5);

  - 깊은 복사.
  - Mat::clone() 함수는 인자로 전달된 m행렬에 자기 자신을 복사 합니다.
  - copyTo()함수를 호출한 행렬과 인자로 전달된 행렬 m이 서로 크기와 타입이 같으면 원소 값 복사만 수행합니다. 서로 크기 또는 타입이 다르면 Mat::copyTo()함수 내부에서 행렬 m을 새로 생성한 후 ㅣㄱ셀 값을 복사합니다.

- imshow

  - 영상을 모두 새창으로 출력.

### 부분 행렬 추출

- Mat img1 = imread("cat.bmp");

  Mat img2 = img1(Rect(220, 120, 340, 240));

  - img1 영상의 (220, 120)좌표부터 340 * 240 크기만큼의 사각형 부분 영상을 추출하는 코드
  - 추출후 img2에 저장

- img2 = ~img2;

  - im2의 영상을 반전하여 그 결과를 img2에 저장.

- Mat img3 = img1(Rect(220, 120, 340, 240)).clone();

  - img1 영상과 img3 영상은 서로 다른 메모리 공간을 사용하며, img3 영상의 픽셀 값을 변경해도 img1 영상은 변경 안됨.

### 행렬의 원소 값 참조

- Mat mat1 = Mat::zeros(3, 4, CV_8UC1);
  - 0으로 초기화된 3 * 4 행렬
  - uchar 자료형 사용. 
- Mat::at() 함수
  - <>안에 uchar자료형을 명시
  - 템플릿으로 지정되어 있기에 행렬 원소의 자료형을 지정해줘야함.
  - 바깥쪽 for 반복문은 전체 행에 대한 반복
  - 안쪽 for 반복문은 전체 열에 대한 반복
  - 하지만 행렬의 크기를 벗어나면 에러 발생
- Mat::ptr() 함수
  - 인자로 전달된 y번째 행의 시작 주소를 반환.
  - 템플릿으로 지정되어 있기에 행렬 원소의 자료형을 지정해줘야함.
  - 지정한 자료형의 포인터를 반환, 이 포인터로 지정한 행의 원소에 접근 가능.
  - 하지만 행렬의 크기를 벗어나면 에러 발생
- Matlterator_ 반복자 사용 방법
  - Mat 행렬 원소 참조를 위한 반복자 변수를 만들어서 행렬 크기에 상관없이 행렬 전체 원소를 차례대로 참조.
  - Mat::begin() 함수를 이용하여 행렬의 첫 번째 원소 위치를 얻을 수 있음.
  - Mat::end()함수를 이용하여 마지막 원소 바로 다음 위치를 얻을 수 있음.

### 행렬 정보 참조

- Mat img1 = imread("lenna.bmp");

  	cout << "Width: " << img1.cols << endl;
  	cout << "Height: " << img1.rows << endl;

  - img1의 가로 크기를 출력하기 위해 img1.cols를 사용.
  - 세로 크기를 출력하기 위해 img1.rows 사용

- if (img1.type() == CV_8UC1)

  ​        cout << "img1 is a grayscale image." << endl;

  ​    else if (img1.type() == CV_8UC3)

  ​        cout << "img1 is a truecolor image." << endl;

  - imread() 함수의 두번째 인자를 받지 않았기에 3컬러 영상으로 생성. 

- float data[] = { 2.f, 1.414f, 3.f, 1.732f };

  ​    Mat mat1(2, 2, CV_32FC1, data);

  ​    cout << "mat1:\n" << mat1 << endl;

  - float 자료형을 사용하는 2 by 2 행렬

  - [2, 1,414

     3, 1,732] 로 나타남

  - CV_32FC1, 실수형 32비트 1채널

### 행렬 연산

- inv(), 역행렬 계산 방법(정사각행렬과 단위행렬에 대하여 단위행렬을 만족하는 행렬)
- mat1.t(), 전치행렬의 표현법

### 크기 및 타입 변환 함수

- convertTo()함수로 CV_8UC1 타입의 행렬을 CV_32FC1 타입으로 변경
- img1, uchar자료형 대신 float자료형을 사용
- reshape() 함수는 주어진 행렬의 크기 또는 행렬 수를 변경.
  - 원소 데이터를 복사하여 새로운 행렬을 만드는 것이 아니라 하나의 행렬 원소 데이터를 같이 참조하는 행렬을 반환
- resize(size_t sz, const Scalar& s);
  - resize() 함수는 행렬의 행 개수를 sz개로 변경!
  - 기존 행렬의 행 개수보다 크면 아래쪽에 행을 추가
  - 새로 추가된 행의 원소는 모두 s로 설정
- push_back() 함수는 이미 존재하는 행렬에 원소 데이터를 추가
  - mat3는 원소가 모두 255로 설정되어 있는 1행 4열 행렬.
  - push_back함수를 실행하면 mat3 행렬을 기존 5 * 4크기의 행렬 mat1 맨아래에 추가
